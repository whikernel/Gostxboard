C'est plutôt simple en fait,.. mais quand on le sait..
Au niveau de mon application je reçois des "char" que je suis donc obligé de 
remapper en "VK_codes" (codes virtuels) pour pouvoir ensuite les mapper en 
"scan codes"(codes clavier) et les déchiffrer. J'utilise
donc la fonction VkKeyScan(char) qui renvoie un short. 
C'est là que je n'ai pas fait attention, mais les bits de poids fort du short 
représentent un flag qui indique si une touche de fonction a été appuyé et 
les bits de poids faibles le scan code correspondant à la touche appuyée. 
Le problème c'est que pour mapper j'utilise 4 fois des fonctions de
mappage. (Char->VkCodes->ScanCodes(Dechiffrement)->VkCodes->Char). Or certaines 
de ces fonctions utilisent des SHORTs, d'autres des entiers et d'autres des 
unsigned int/short. Bref, à force de caster, je perd mon flag et ça affiche donc des 
majuscules à la sortie. J'ai pas encore réussis à trouver exactement à 
quel moment la perte se fait par contre..
Pour contrer ce phénomène, au moment de l'appel à la fonction VkKeyScan je regarde 
les bits de poids fort et enrgistre donc la touche SHIFT a été appuyée ou non. 
A coup de décalage, j'initialise ces bits à zéro (la fonction de mappage suivante 
plante sinon.. Encore un mystère.. ), je déchiffre et remappe et à la fin, 
avant le dernier remappage en VkCodes je remet le flag original. 
Il y a encore pas mal de choses qui me sont un peu mystérieuses (pourquoi la fonction 
de mappage plante, quand est-ce que je perd le flag ?..).
J'avance un peu, et puis je vais essayer de voir pourquoi.